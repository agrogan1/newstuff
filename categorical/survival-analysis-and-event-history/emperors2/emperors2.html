<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andy Grogan-Kaylor">
<meta name="dcterms.date" content="2023-11-12">

<title>Event History Analysis With Roman Emperor’s Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="emperors2_files/libs/clipboard/clipboard.min.js"></script>
<script src="emperors2_files/libs/quarto-html/quarto.js"></script>
<script src="emperors2_files/libs/quarto-html/popper.min.js"></script>
<script src="emperors2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="emperors2_files/libs/quarto-html/anchor.min.js"></script>
<link href="emperors2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="emperors2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="emperors2_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="emperors2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="emperors2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="emperors2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="emperors2_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#get-data-and-data-wrangling" id="toc-get-data-and-data-wrangling" class="nav-link" data-scroll-target="#get-data-and-data-wrangling"><span class="header-section-number">2</span> Get Data and Data Wrangling</a></li>
  <li><a href="#cox-proportional-hazards-model" id="toc-cox-proportional-hazards-model" class="nav-link" data-scroll-target="#cox-proportional-hazards-model"><span class="header-section-number">3</span> Cox Proportional Hazards Model</a>
  <ul class="collapse">
  <li><a href="#stset-the-data" id="toc-stset-the-data" class="nav-link" data-scroll-target="#stset-the-data"><span class="header-section-number">3.1</span> <code>stset</code> the Data</a></li>
  <li><a href="#formula-for-the-hazard" id="toc-formula-for-the-hazard" class="nav-link" data-scroll-target="#formula-for-the-hazard"><span class="header-section-number">3.2</span> Formula for the Hazard </a><a id="hazard-formula" class="nav-link" data-scroll-target="undefined" href=""></a></li>
  <li><a href="#estimate-the-cox-proportional-hazards-model" id="toc-estimate-the-cox-proportional-hazards-model" class="nav-link" data-scroll-target="#estimate-the-cox-proportional-hazards-model"><span class="header-section-number">3.3</span> Estimate the Cox Proportional Hazards Model</a></li>
  <li><a href="#proportional-hazards-assumption" id="toc-proportional-hazards-assumption" class="nav-link" data-scroll-target="#proportional-hazards-assumption"><span class="header-section-number">3.4</span> Proportional Hazards Assumption </a><a id="ph-assumption" class="nav-link" data-scroll-target="undefined" href=""></a></li>
  <li><a href="#correcting-for-violations-of-the-proportional-hazards-assumption" id="toc-correcting-for-violations-of-the-proportional-hazards-assumption" class="nav-link" data-scroll-target="#correcting-for-violations-of-the-proportional-hazards-assumption"><span class="header-section-number">3.5</span> Correcting For Violations of the Proportional Hazards Assumption</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">4</span> References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="emperors2.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Event History Analysis With Roman Emperor’s Data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andy Grogan-Kaylor </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 12, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This example uses data on the ages of death of Roman Emperors. Sources for this data are unclear, but it appears that the original source is <a href="http://www.roman-emperors.org/">http://www.roman-emperors.org/</a> via <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-08-13">https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-08-13</a>.</p>
</section>
<section id="get-data-and-data-wrangling" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Get Data and Data Wrangling</h1>
<div class="cell" data-collectcode="true">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">clear</span> <span class="ot">all</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>import delimited <span class="st">"https://raw.githubusercontent.com/agrogan1/newstuff/master/categorical/survival-analysis-and-event-history/emperors/emperors.csv"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span> <span class="kw">in</span> 3 <span class="co">// list out an observation</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">generate</span> birthyear = <span class="fu">real</span>(<span class="fu">substr</span>(birth, 1, 4)) <span class="co">// convert first 4 characters to real number</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">generate</span> reignyear = <span class="fu">real</span>(<span class="fu">substr</span>(reign_start, 1, 4)) <span class="co">// convert first 4 characters to real number</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">generate</span> agereign = reignyear - birthyear</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">if</span> agereign &lt;0 <span class="co">// drop negative ages at rise to power</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="kw">histogram</span> agereign</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">encode</span> rise, <span class="kw">generate</span>(riseNUMERIC) <span class="co">// numeric version of rise to power</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="kw">save</span> emperors2.dta, <span class="kw">replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(encoding automatically selected: ISO-8859-1)
(16 vars, 68 obs)

     +-------------------------------------------------------------------------+
  3. | index |     name |                               name_full |      birth |
     |     3 | Caligula | GAIVS IVLIVS CAESAR AVGVSTVS GERMANICVS | 0012-08-31 |
     |------------------------------------------------------------+------------|
     |      death | birth_~y | birth_~v |       rise | reign_st~t |  reign_end |
     | 0041-01-24 |  Antitum |   Italia | Birthright | 0037-03-18 | 0041-01-24 |
     |-------------------------------------------------------------------------|
     |           cause   |   killer    |          dynasty    |          era    |
     |   Assassination   |   Senate    |   Julio-Claudian    |   Principate    |
     |-------------------------------------------------------------------------|
     |                                                            notes        |
     |        assassination may have only involved the Praetorian Guard        |
     |-------------------------------------------------------------------------|
     |                                      verif_who                          |
     |                         Reddit user zonination                          |
     +-------------------------------------------------------------------------+

(5 missing values generated)


(5 missing values generated)

(2 observations deleted)

(bin=7, start=4, width=10.714286)


file emperors2.dta saved</code></pre>
</div>
</div>
</section>
<section id="cox-proportional-hazards-model" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Cox Proportional Hazards Model</h1>
<section id="stset-the-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="stset-the-data"><span class="header-section-number">3.1</span> <code>stset</code> the Data</h2>
<p>We need to <code>stset</code> the data so that Stata knows that this is survival data with special characteristics relevant to survival analysis. For those of you have used other commands that attach special characteristics to the data, this is similar to using <code>svyset</code> for complex survey data, <code>xtset</code> for panel data, or even to the <code>mi</code> suite of commands for multiple imputation.</p>
<p>The most commonly used syntax is something like <code>stset timevar, failure(failvar) id(id)</code> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<blockquote class="blockquote">
<p>There are many ways to specify <code>failvar</code>, we outline the most straightforward. Consult Stata help for your exact situation.</p>
</blockquote>
</section>
<section id="formula-for-the-hazard" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="formula-for-the-hazard"><span class="header-section-number">3.2</span> Formula for the Hazard <a id="hazard-formula" href=""></a></h2>
<p><span class="math inline">\(h(t)\)</span> the rate of occurrence.</p>
<p><span class="math display">\[
    h(t) = \lim_{\delta\to\infty} \frac{\text{probability of having an event before time } t + \delta}{\delta}
\]</span></p>
<p>This definition per Johnson &amp; Shih (2007).</p>
<p><span class="math display">\[
    h(t) = h_0(t)e^{\beta_1 x1 + \beta_2 x_2 + etc.}
\]</span></p>
<blockquote class="blockquote">
<p>We don’t directly estimate the hazard, but estimate the effect of covariates on the hazard.</p>
</blockquote>
</section>
<section id="estimate-the-cox-proportional-hazards-model" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="estimate-the-cox-proportional-hazards-model"><span class="header-section-number">3.3</span> Estimate the Cox Proportional Hazards Model</h2>
<div class="cell" data-collectcode="true">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> emperors2.dta, <span class="kw">clear</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">stset</span> agereign <span class="co">// stset the data</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">sts</span> <span class="kw">graph</span>, <span class="kw">by</span>(riseNUMERIC) <span class="co">// survival curve by cause of death</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">graph</span> <span class="kw">export</span> survival.png, <span class="kw">width</span>(1000) <span class="kw">replace</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">stcox</span> ib5.riseNUMERIC <span class="co">// Cox model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Survival-time data settings

         Failure event: (assumed to fail at time=agereign)
Observed time interval: (0, agereign]
     Exit on or before: failure

--------------------------------------------------------------------------
         66  total observations
          5  event time missing (agereign&gt;=.)               PROBABLE ERROR
--------------------------------------------------------------------------
         61  observations remaining, representing
         61  failures in single-record/single-failure data
      2,470  total analysis time at risk and under observation
                                                At risk from t =         0
                                     Earliest observed entry t =         0
                                          Last observed exit t =        79

        Failure _d: 1 (meaning all fail)
  Analysis time _t: agereign

file
    /Users/agrogan/Desktop/GitHub/newstuff/categorical/survival-analysis-and-event-hi
    &gt; story/emperors2/survival.png saved as PNG format

        Failure _d: 1 (meaning all fail)
  Analysis time _t: agereign

Iteration 0:  Log likelihood = -194.68581
Iteration 1:  Log likelihood = -178.34744
Iteration 2:  Log likelihood = -177.31187
Iteration 3:  Log likelihood = -177.29895
Iteration 4:  Log likelihood = -177.29895
Refining estimates:
Iteration 0:  Log likelihood = -177.29895

Cox regression with Breslow method for ties

No. of subjects =    61                                 Number of obs =     61
No. of failures =    61
Time at risk    = 2,470
                                                        LR chi2(7)    =  34.77
Log likelihood = -177.29895                             Prob &gt; chi2   = 0.0000

--------------------------------------------------------------------------------------
                  _t | Haz. ratio   Std. err.      z    P&gt;|z|     [95% conf. interval]
---------------------+----------------------------------------------------------------
         riseNUMERIC |
Appointment by Army  |   .3840617   .1639473    -2.24   0.025     .1663574    .8866653
Appointment by Em..  |   .4437168   .2711353    -1.33   0.184     .1339599    1.469727
Appointment by Pr..  |   .1063576   .0739064    -3.22   0.001     .0272446    .4151993
Appointment by Se..  |   .0745311   .0434844    -4.45   0.000     .0237527    .2338635
           Election  |   .6231605   .6379254    -0.46   0.644     .0837974    4.634144
           Purchase  |   .1205918   .1271354    -2.01   0.045     .0152731    .9521544
       Seized Power  |   .2240689   .0940928    -3.56   0.000     .0983872    .5102992
--------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="survival.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Survival Plot</figcaption>
</figure>
</div>
</section>
<section id="proportional-hazards-assumption" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="proportional-hazards-assumption"><span class="header-section-number">3.4</span> Proportional Hazards Assumption <a id="ph-assumption" href=""></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> emperors2.dta, <span class="kw">clear</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">stset</span> agereign <span class="co">// stset the data</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">quietly</span>: <span class="kw">stcox</span> ib5.riseNUMERIC <span class="co">// Cox model</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">estat</span> phtest, <span class="kw">detail</span> <span class="co">// formal test of PH assumption</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="kw">stphplot</span>, <span class="kw">by</span>(riseNUMERIC) <span class="dv">scheme</span>(michigan) <span class="co">// graphical test of PH assumption</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="kw">graph</span> <span class="kw">export</span> ph.png, <span class="kw">width</span>(1000) <span class="kw">replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Survival-time data settings

         Failure event: (assumed to fail at time=agereign)
Observed time interval: (0, agereign]
     Exit on or before: failure

--------------------------------------------------------------------------
         66  total observations
          5  event time missing (agereign&gt;=.)               PROBABLE ERROR
--------------------------------------------------------------------------
         61  observations remaining, representing
         61  failures in single-record/single-failure data
      2,470  total analysis time at risk and under observation
                                                At risk from t =         0
                                     Earliest observed entry t =         0
                                          Last observed exit t =        79



Test of proportional-hazards assumption

Time function: Analysis time
--------------------------------------------------------
             |        rho     chi2       df    Prob&gt;chi2
-------------+------------------------------------------
1.riseNUME~C |    0.22588     2.76        1       0.0969
2.riseNUME~C |    0.15586     1.37        1       0.2414
3.riseNUME~C |    0.03204     0.05        1       0.8209
4.riseNUME~C |   -0.04249     0.11        1       0.7352
5b.riseNUM~C |          .        .        1           .
6.riseNUME~C |    0.11688     0.78        1       0.3765
7.riseNUME~C |    0.09609     0.47        1       0.4944
8.riseNUME~C |    0.16179     1.47        1       0.2251
-------------+------------------------------------------
 Global test |                5.91        7       0.5504
--------------------------------------------------------

        Failure _d: 1 (meaning all fail)
  Analysis time _t: agereign

file
    /Users/agrogan/Desktop/GitHub/newstuff/categorical/survival-analysis-and-event-hi
    &gt; story/emperors2/ph.png saved as PNG format</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ph.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Graphical Assessment of Proportional Hazards Assumptions</figcaption>
</figure>
</div>
</section>
<section id="correcting-for-violations-of-the-proportional-hazards-assumption" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="correcting-for-violations-of-the-proportional-hazards-assumption"><span class="header-section-number">3.5</span> Correcting For Violations of the Proportional Hazards Assumption</h2>
<p>Had the proportional hazards assumption been violated, we could correct for this violation in one of two ways:</p>
<ol type="1">
<li>Estimating an interaction of the time variable (in this case <code>age</code>) with the variable violating the assumption.</li>
</ol>
<p>e.g.&nbsp;<code>stcox age#ib5.riseNUMERIC</code>.</p>
<blockquote class="blockquote">
<p>Note: In this relatively small sample this command fails to converge, perhaps because of sample size; or perhaps because there is no underlying violation of the proportional hazards assumption.</p>
</blockquote>
<ol start="2" type="1">
<li>Using the <code>, strata(varname)</code> option to <em>stratify</em> on the variable violating the assumption.</li>
</ol>
<blockquote class="blockquote">
<p>Note that the command below provides results, but does not provide parameter estimates for the variable on which we are stratifying, <code>riseNUMERIC</code>.</p>
</blockquote>
<pre><code>stcox, strata(riseNUMERIC)</code></pre>
</section>
</section>
<section id="references" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> References</h1>
<p>Johnson, L. L., &amp; Shih, J. H. (2007). CHAPTER 20 - An Introduction to Survival Analysis (J. I. Gallin &amp; F. P. Ognibene, eds.). https://doi.org/https://doi.org/10.1016/B978-012369440-9/50024-4</p>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><code>failvair</code> is often something like <code>died</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>