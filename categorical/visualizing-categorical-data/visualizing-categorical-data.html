<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<style>
/* CSS for Markstat 2.0 using Pandoc 2.0 */
body{padding:14px 28px;}
body, table {font-family: Helvetica, Arial, Sans-serif; font-size: 14px;}
h1, h2, h3, h4 {font-weight: normal; color: #3366cc}
h1 {font-size: 200%;}
h2 {font-size: 150%;}
h3 {font-size: 120%;}
h4 {font-size: 100%; font-weight:bold}
img.center {display:block; margin-left:auto; margin-right:auto}
.small{font-size:8pt;}
a {color: black;}
a:visited {color: #808080;}
a.plain {text-decoration:none;}
a.plain:hover {text-decoration:underline;}
.em {font-weight:bold;}
pre, code {font-family: "lucida console", monospace;}
pre.stata {font-size:13px; line-height:13px;}
pre {padding:8px; border:1px solid #c0c0c0; border-radius:8px; background-color:#fdfdfd;}
code {color:#3366cc; background-color:#fafafa;}
pre code { color:black; background-color:white}
/* Added for Pandoc */
figure > img, div.figure > img {display:block; margin:auto}
figcaption, p.caption {text-align:center; font-weight:bold; color:#3366cc;}
h1.title {text-align:center; margin-bottom:0}
p.author, h2.author {font-style:italic; text-align:center;margin-top:4px;margin-bottom:0}
p.date, h3.date {text-align:center;margin-top:4px; margin-bottom:0}
/* Tables*/
table { margin:auto; border-collapse:collapse; }
table caption { margin-bottom:1ex;}
th, td { padding:4px 6px;}
thead tr:first-child th {border-top:1px solid black; padding-top:6px}
thead tr:last-child  th {padding-bottom:6px}
tbody tr:first-child td {border-top:1px solid black; padding-top:6px}
tbody tr:last-child  td {padding-bottom:6px;}
table tbody:last-child tr:last-child td {border-bottom:1px solid black;}
</style>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Andy Grogan-Kaylor" />
  <title>Visualizing Categorical Data With French Skiiers Data</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Visualizing Categorical Data With French Skiiers Data</h1>
<p class="author">Andy Grogan-Kaylor</p>
<p class="date">21 Jul 2021 11:54:46</p>
</header>
<style>body {max-width: 90%} h1 {color: #00274C;} h2 {color: #2F65A7;} blockquote {border-left: 5px solid #ffcb05; margin: 1.5em 10px; padding: 0.5em 10px;} code {color: red;}</style>
<h1 id="background">Background</h1>
<p>Visualizing categorical data presents its own unique challenges. Creating graphs may be easy, but creating graphs that effectively tell a story, or impart a message, may require additional effort.</p>
<p>There are multiple commands that may be useful, <code>spineplot</code>, <code>graph bar</code>, and <code>graph pie</code>.</p>
<p>The general useage of these commands is hopefully fairly simple, and is as follows:</p>
<ul>
<li><code>spineplot y x</code></li>
<li><code>graph bar, over(y) by(x)</code></li>
<li><code>graph pie, over(y) by (x)</code></li>
</ul>
<p>Our graphing task is made a little bit more complicated because we have <em>weighted</em> data where every row of data represents multiple observations, so we need to include <code>[fweight = Count]</code> in order to let Stata know that we have weighted data.</p>
<p>We also add options to various graphs to make them more informative.</p>
<h1 id="data">Data</h1>
<p>We use the <em>French Skiiers</em> data.</p>
<pre class='stata'>. use "FrenchSkiiers.dta", clear
</pre>
<h1 id="x-2-table">2 X 2 Table</h1>
<p>A 2 X 2 Table may be helpful</p>
<pre class='stata'>. tabulate Outcome Tx [fweight=Count], row col

┌───────────────────┐
│ Key               │
├───────────────────┤
│     frequency     │
│  row percentage   │
│ column percentage │
└───────────────────┘

           │          Tx
   Outcome │   Placebo  Ascorbic  │     Total
───────────┼──────────────────────┼──────────
   No Cold │       109        122 │       231 
           │     47.19      52.81 │    100.00 
           │     77.86      87.77 │     82.80 
───────────┼──────────────────────┼──────────
      Cold │        31         17 │        48 
           │     64.58      35.42 │    100.00 
           │     22.14      12.23 │     17.20 
───────────┼──────────────────────┼──────────
     Total │       140        139 │       279 
           │     50.18      49.82 │    100.00 
           │    100.00     100.00 │    100.00 
</pre>
<p>We note from the column percentages that allocation to the placebo or treament (ascorbic acid) was roughly 50% in each group (1 subject dropped out of the study). We further note from the within column percentages that 22.14% of those receiving the placebo got colds while only 12.23% of those receiving ascorbic acid got colds.</p>
<h1 id="spineplot-mosaic-plot">Spineplot (Mosaic Plot)</h1>
<p>A <em>Spineplot</em>, more often called a <em>Mosaic Plot</em> is illustrative of these 2 X 2 relationships. A basic <em>spineplot</em> demonstrates the <em>spineplot</em> idea, but perhaps not as informative as it might be.</p>
<pre class='stata'>. spineplot Outcome Tx [fweight=Count]

. 
. graph export myspineplot1.png, width(1000) replace
file
    /Users/agrogan/Desktop/GitHub/newstuff/categorical/visualizing-categorical-data/myspinep
    > lot1.png saved as PNG format
</pre>
<figure>
<img src="myspineplot1.png" style="width:50.0%" alt="Spine Plot or Mosaic Plot" /><figcaption aria-hidden="true">Spine Plot or Mosaic Plot</figcaption>
</figure>
<p>We add options to clarify the spineplot, which have the unfortunate effect of making the syntax more complicated and less intuitive. Hopefully, however we still see the core syntax of <code>spineplot Outcome Tx</code> is still there, and everything after the <code>,</code> is just options.</p>
<p>Observe especially that we have added <code>note()</code>’s to the graph to clarify the meaning of the spineplot.</p>
<pre class='stata'>. spineplot Outcome Tx [fweight=Count], ///
> bar2(fintensity(%100)) /// set intensity for bar 2
> title("Fewer Colds Among Those Recieving Ascorbic Acid") /// title
> note("Allocation to Treament vs. Placebo is Roughly Equal" ///
> "Fewer Colds Among Those Recieving Treatment") /// note
> xtitle("Treatment Allocation", axis(2)) /// xtitle on axis(2)
> xtitle(" ", axis(1)) /// blank x title on axis(1)
> ytitle("Outcome", axis(2)) /// ytitle on axis(2)
> text(Count, mlabcolor(black)) /// add Count variable to boxes
> scheme(michigan) // Michigan graph scheme
(note:  named style % 100 not found in class intensity, default attributes used)

.     
. graph export myspineplot2.png, width(1000) replace
file
    /Users/agrogan/Desktop/GitHub/newstuff/categorical/visualizing-categorical-data/myspinep
    > lot2.png saved as PNG format
</pre>
<figure>
<img src="myspineplot2.png" style="width:75.0%" alt="Spine Plot or Mosaic Plot" /><figcaption aria-hidden="true">Spine Plot or Mosaic Plot</figcaption>
</figure>
<blockquote>
<p>The spineplot makes clear that the allocation to the treatment vs. placebo was roughly 50/50. Note, that if the allocation had not been 50/50 the spineplot would have made this clear as well.</p>
</blockquote>
<blockquote>
<p>With enough annotations, the spineplot <em>may</em> make it clear that the treatment appears to result in a lower rate of colds than the placebo.</p>
</blockquote>
<h1 id="bar-graph">Bar Graph</h1>
<p>We try a bar graph.</p>
<pre class='stata'>. graph bar [fweight = Count], over(Outcome) /// 
> asyvars /// different colors for bars
> blabel(bar, format(%9.4g) size(medium)) /// bars labelled with bar height
> yscale(range(0 100)) /// y scale from 0 to 100
> by(Tx, title("Fewer Colds Among Those Recieving Ascorbic Acid")) /// title (inside by comman
> d)
> scheme(michigan) // Michigan graph scheme

.     
. graph export mybargraph1.png, width(1000) replace
file
    /Users/agrogan/Desktop/GitHub/newstuff/categorical/visualizing-categorical-data/mybargra
    > ph1.png saved as PNG format
</pre>
<figure>
<img src="mybargraph1.png" style="width:50.0%" alt="Bar Graph" /><figcaption aria-hidden="true">Bar Graph</figcaption>
</figure>
<blockquote>
<p>The bar graph tells a <em>very</em> clear story about <em>outcomes</em>. However, this version of a bar graph <em>does not</em> make clear what percentage was allocated to treatment and what percentage was allocated to control, which might be an important part of our story.</p>
</blockquote>
<h1 id="pie-chart">Pie Chart</h1>
<pre class='stata'>. graph pie [fweight = Count], over(Outcome) ///
> by(Tx, title("Fewer Colds Among Those Recieving Ascorbic Acid")) /// title (inside by comman
> d)
> plabel(1 percent, place(0) color(white)) /// label with percentages; placed in center of sli
> ce
> plabel(2 percent, place(0)) /// label with percentages; placed in center of slice
> scheme(michigan) // Michigan graph scheme

. 
. graph export mypie2.png, width(1000) replace
file
    /Users/agrogan/Desktop/GitHub/newstuff/categorical/visualizing-categorical-data/mypie2.p
    > ng saved as PNG format
</pre>
<figure>
<img src="mypie2.png" style="width:50.0%" alt="Pie Chart" /><figcaption aria-hidden="true">Pie Chart</figcaption>
</figure>
<blockquote>
<p>The pie chart also tells a <em>very</em> clear story about <em>outcomes</em>. Similar to the bar plot, however, the pie chart <em>does not</em> make clear what percentage was allocated to treatment and what percentage was allocated to control, which might be an important part of our story.</p>
</blockquote>
<h1 id="waffle-chart">Waffle Chart</h1>
<p>Then, we try a waffle chart, which requires the use of R and the <code>waffle</code> library. The R script used to generate the figure below is <a href="./mywaffle.R">here</a>.</p>
<figure>
<img src="mywaffle.png" style="width:75.0%" alt="Waffle Chart" /><figcaption aria-hidden="true">Waffle Chart</figcaption>
</figure>
<blockquote>
<p>The waffle chart is very visually appealing. With enough inspection, the waffle chart <em>may</em> make clear that the allocation to the treatment vs. placebo was roughly 50/50. Note, that if the allocation had not been 50/50 the waffle chart would have made this clear as well. As with the spineplot (mosaic plot), with enough annotations, the waffle chart <em>may</em> make it clear that the treatment appears to result in a lower rate of colds than the placebo.</p>
</blockquote>
<h1 id="alluvial-diagram">Alluvial Diagram</h1>
<p>Finally, we try an alluvial diagram, which requires the use of R and the <code>ggalluvial</code> library. The R script used to generate the figure below is <a href="./myalluvial.R">here</a>.</p>
<figure>
<img src="myalluvial.png" style="width:50.0%" alt="Alluvial Diagram" /><figcaption aria-hidden="true">Alluvial Diagram</figcaption>
</figure>
<blockquote>
<p>The alluvial diagram is also very visually appealing, but may also not be the most clear presentation of information. With enough inspection, the alluvial chart <em>may</em> make clear that the allocation to the treatment vs. placebo was roughly 50/50. Note, that if the allocation had not been 50/50 the alluvial chart would have made this clear as well. As with the spineplot (mosaic plot), with enough annotations, the alluvial chart <em>may</em> make it clear that the treatment appears to result in a lower rate of colds than the placebo. Using <code>ggalluvial</code> it is difficult to add annotations for counts or percentages to the alluvial diagram, but these could be added in post-production with software like Adobe Illustrator.</p>
</blockquote>
</body>
</html>
