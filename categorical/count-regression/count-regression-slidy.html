<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Andy Grogan-Kaylor" />
  <title>Count Regression</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="https://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
   href="../UMslidy.css" />
  <script src="https://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js"
    charset="utf-8" type="text/javascript"></script>
	<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Count Regression</h1>
  <p class="author">
Andy Grogan-Kaylor
  </p>
</div>
<div id="title-block-header">
<div id="count-regression" class="title-slide slide section level1 title">
<h1 class="title">Count Regression</h1>
<p>Andy Grogan-Kaylor</p>
<p>16 Oct 2021</p>
</div>

</div>
<div id="key-concepts-and-commands" class="title-slide slide section level1">
<h1>Key Concepts and Commands</h1>
<ul class="incremental">
<li>formulas are our friends</li>
</ul>
<p><span class="math inline">\(F(y) = \beta_0 + \beta_1 x_1 + ...\)</span></p>
<p><span class="math inline">\(y = \ln(count): 1, 2, 3, \text{etc.}\)</span></p>
<ul class="incremental">
<li><p>Think about IRRâ€™s, predicted counts, non-linearity</p></li>
<li><p>So much of categorical data analysis depends upon arguments for â€œfunctional formâ€. When do we think these arguments are valid?</p></li>
</ul>
</div>

<div id="the-count" class="title-slide slide section level1">
<h1>The Count</h1>
<div class="figure">
<img src="../images/Sesame-Street-optimize.gif" alt="" />
<p class="caption">The Count and Friends</p>
</div>
</div>

<div id="historical-examples-of-count-data" class="title-slide slide section level1">
<h1>Historical Examples of Count Data ğŸ â˜ï¸ ğŸ¥</h1>
<ul class="incremental">
<li>ğŸ Deaths from horsekicks in the Prussian Army</li>
<li>â˜ï¸ Calls to a call center (business, crisis hotline, etc.)</li>
<li>ğŸ¥ Arrivals at the Emergency Room</li>
</ul>
<p>From the Stata documentation:</p>
<blockquote>
<p>â€œPoisson regression fits models of the number of occurrences (counts) of an event. The Poisson distribution has been applied to diverse events, such as the number of soldiers kicked to death by horses in the Prussian army (von Bortkiewicz 1898); the pattern of hits by buzz bombs launched against London during World War II (Clarke 1946); telephone connections to a wrong number (Thorndike 1926); and disease incidence, typically with respect to time, but occasionally with respect to space.â€</p>
</blockquote>
</div>

<div id="other-canonical-examples-of-count-data" class="title-slide slide section level1">
<h1>Other Canonical Examples of Count Data ğŸŒ³ğŸ¤’</h1>
<ul class="incremental">
<li>ğŸŒ³ğŸŒ³ğŸŒ³ Plants / trees in a field</li>
<li>ğŸ¤’ğŸ¤’ğŸ¤’ Cases of disease / unit area</li>
</ul>
</div>

<div id="poisson-distribution" class="title-slide slide section level1">
<h1>Poisson Distribution</h1>

</div>
<div id="theorizing-about-the-poisson" class="slide section level2">
<h1>Theorizing about the Poisson ğŸŸğŸŸğŸŸ ğŸŒ²ğŸŒ²ğŸŒ²</h1>
<blockquote>
<p>The Poisson distribution is a modified form of the binomial distribution that is useful for the analysis of phenomena characterized by discrete, rare events. For example, in a study of the distribution of a rare plant among a number of quadrats, a majority of plots may contain no specimens, a smaller number a single plant, and still smaller numbers two, three, or more plants. If a single plant per quadrat is expected, the mean Âµ = 1 and the â€œ0â€ and â€œ1â€ classes occur at 37% each, the â€œ2â€ class at 18%, the â€œ3â€ class at 6%, and larger classes take up the remaining 2%. The characteristic test for a Poisson is that the variance equals the mean, which in the plant example means that the rare plant is randomly distributed. Note, that, In the distributions above, as the mean <span class="math inline">\(\mu\)</span> increases towards 10, the distribution approaches normality.</p>
</blockquote>
<blockquote>
<p>The Poisson may be used to evaluate whether events occur independently in time as well as space. In a classic example, Bortkiewicz (1898) studied the distribution of 122 men kicked to death by horses among ten Prussian army corps over 20 years. In most years in most corps, no one dies from being kicked; in one corp in one year, four men were kicked to death. Does this mean something was amiss in this particular corp? Analysis indicates that the observed frequencies conform quite closely to the expected Poisson frequencies, and that the mean and variance are almost identical, as expected. The corp was just â€œunluckyâ€ in the sense that it is in the extreme tail of an ordinary run of events.</p>
</blockquote>
<p><a href="http://www.mun.ca/biology/scarr/smcPoisson_distributions.html">http://www.mun.ca/biology/scarr/smcPoisson_distributions.html</a></p>
</div>
<div id="reprise-of-normal-distribution" class="slide section level2">
<h1>Reprise of Normal Distribution</h1>
<p>Normal distribution:</p>
<p><span class="math display">\[ P(x) = \frac{1}{\sigma \sqrt{2 \pi}} e^{-(x-\mu)^2/(2 \sigma^2)} \]</span></p>
<p>Standardized Normal Distribution:</p>
<p><span class="math display">\[ P(z) = \frac{1}{\sqrt{2 \pi}} e^{-z^2/2} \]</span></p>
<p>2 parameters:</p>
<p><span class="math display">\[ x \sim N(\mu,\sigma) \]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">clear</span> <span class="ot">all</span> <span class="co">// clear all for simulated data</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">set</span> <span class="kw">obs</span> 1000 <span class="co">// number of observations</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Number <span class="kw">of</span> observations (_N) was 0, now 1,000.</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> x = rnormal() <span class="co">// normally distributed random variable</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">histogram</span> x, <span class="bn">title</span>(<span class="st">&quot;Normally Distributed Random Variable&quot;</span>) <span class="dv">scheme</span>(michigan)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>(<span class="bn">bin</span>=29, <span class="bn">start</span>=-3.0031285, <span class="kw">width</span>=.20304677)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">graph</span> <span class="kw">export</span> myhistogram.png, <span class="kw">width</span>(500) <span class="kw">replace</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>file /Users/agrogan/Desktop/GitHub/newstuff/categorical/<span class="fu">count</span>-regression/myhistogram.png saved <span class="kw">as</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    PNG <span class="kw">format</span></span></code></pre></div>
<div class="figure">
<img src="myhistogram.png" alt="" />
<p class="caption">histogram of random normal variable</p>
</div>
</div>
<div id="poisson-distribution-1" class="slide section level2">
<h1>Poisson Distribution</h1>
<p><span class="math display">\[ P(Y=y) = e^{-\lambda} \frac{\lambda^y}{y!} \]</span></p>
<blockquote>
<p><span style="background-color: #FFFF00">A Poisson with large lambda looks very similar to a normal distribution.</span></p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> <span class="fu">w</span> = rpoisson(.5)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">histogram</span> <span class="fu">w</span>, <span class="bn">title</span>(<span class="st">&quot;Poisson Distributed Random Variable&quot;</span>) <span class="dv">scheme</span>(michigan)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>(<span class="bn">bin</span>=29, <span class="bn">start</span>=0, <span class="kw">width</span>=.13793103)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">graph</span> <span class="kw">export</span> myhistogram2.png, <span class="kw">width</span>(500) <span class="kw">replace</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>file /Users/agrogan/Desktop/GitHub/newstuff/categorical/<span class="fu">count</span>-regression/myhistogram2.png saved</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">as</span> PNG <span class="kw">format</span></span></code></pre></div>
<div class="figure">
<img src="myhistogram2.png" alt="" />
<p class="caption">histogram of random Poisson variable</p>
</div>
</div>
<div id="poisson-is-the-natural-form-for-observations-distributed-in-time-or-space" class="slide section level2">
<h1>Poisson is the Natural Form for Observations Distributed in Time or Space ğŸ›ï¸ğŸ›ï¸ğŸ›ï¸ â³â³â³</h1>
<p><span class="math display">\[ x \sim Poisson(\lambda) \]</span></p>
<blockquote>
<p><span class="math inline">\(\lambda\)</span> is both mean and variance.</p>
</blockquote>
<div class="sourceCode" id="cb9"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">clear</span> <span class="ot">all</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">set</span> <span class="kw">obs</span> 20</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Number <span class="kw">of</span> observations (_N) was 0, now 20.</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> <span class="fu">field</span> = <span class="dt">_n</span> <span class="co">// field number</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> mycount = rpoisson(1)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>. expand mycount <span class="co">// create individual observations</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>(9 <span class="bn">zero</span> counts ignored; observations <span class="kw">not</span> deleted)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>(7 observations created)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> x = runiform(1,10) <span class="co">// random x coordinate</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> <span class="fu">y</span> =runiform(1,10) <span class="co">// random y coordinate</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> mylabel = <span class="st">&quot;ğŸ¦†&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">twoway</span> <span class="kw">scatter</span> <span class="fu">y</span> x, <span class="co">///</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>&gt; <span class="kw">by</span>(<span class="fu">field</span>, <span class="bn">title</span>(<span class="st">&quot;Randomly Located Ducks&quot;</span>)) <span class="co">///</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>&gt; mlab(mylabel) <span class="bn">mlabsize</span>(vlarge) <span class="co">///</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>&gt; <span class="bn">msymbol</span>(<span class="kw">none</span>)  <span class="co">///</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>&gt; <span class="bn">legend</span>(<span class="kw">order</span>(1 <span class="st">&quot;ğŸ¦† Duck&quot;</span>)) <span class="co">///</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>&gt; <span class="dv">scheme</span>(michigan) plotr(fcolor(<span class="bn">olive_teal</span>))</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">graph</span> <span class="kw">export</span> ducks.png, <span class="kw">width</span>(1000) <span class="kw">replace</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>file /Users/agrogan/Desktop/GitHub/newstuff/categorical/<span class="fu">count</span>-regression/ducks.png saved <span class="kw">as</span> PNG</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">format</span></span></code></pre></div>
<div class="figure">
<img src="ducks.png" alt="" />
<p class="caption">Randomly Located Ducks</p>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> t = runiform(1,10) <span class="co">// random time coordinate</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> y2 = runiform(1,2) <span class="co">// random y coordinate</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> mylabel2 = <span class="st">&quot;ğŸ”¥&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">generate</span> timeperiod = <span class="fu">field</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">twoway</span> <span class="kw">scatter</span> y2 t, <span class="co">///</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>&gt; <span class="kw">by</span>(timeperiod, <span class="bn">title</span>(<span class="st">&quot;Forest Fires At Random Times&quot;</span>, <span class="kw">size</span>(vhuge)) <span class="bn">cols</span>(10)) <span class="co">///</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>&gt; <span class="bn">ytitle</span>(<span class="st">&quot;&quot;</span>, <span class="kw">size</span>(<span class="bn">zero</span>)) <span class="kw">ylabel</span>(<span class="kw">none</span>) <span class="bn">xtitle</span>(<span class="st">&quot;&quot;</span>, <span class="kw">size</span>(<span class="bn">zero</span>)) <span class="kw">xlabel</span>(<span class="kw">none</span>) <span class="co">///</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>&gt; <span class="bn">subtitle</span>(, <span class="kw">size</span>(vhuge)) <span class="co">///</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>&gt; mlab(mylabel2) <span class="bn">mlabsize</span>(vhuge) <span class="co">///</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>&gt; <span class="bn">msymbol</span>(<span class="kw">none</span>)  <span class="co">///</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>&gt; <span class="bn">legend</span>(<span class="kw">order</span>(1 <span class="st">&quot;ğŸ”¥ Forest Fire&quot;</span>)) <span class="co">///</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>&gt; <span class="dv">scheme</span>(michigan) plotr(fcolor(gs14)) <span class="co">///</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>&gt; <span class="bn">xsize</span>(5) <span class="bn">ysize</span>(1)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">graph</span> <span class="kw">export</span> fires.png, <span class="kw">width</span>(1000) <span class="kw">replace</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>file /Users/agrogan/Desktop/GitHub/newstuff/categorical/<span class="fu">count</span>-regression/fires.png saved <span class="kw">as</span> PNG</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">format</span></span></code></pre></div>
<div class="figure">
<img src="fires.png" alt="" />
<p class="caption">Forest Fires At Random Times</p>
</div>
</div>

<div id="poisson-regression" class="title-slide slide section level1">
<h1>Poisson Regression</h1>

</div>
<div id="national-survey-of-childrens-health-2018" class="slide section level2">
<h1>National Survey of Childrenâ€™s Health (2018)</h1>
<p>The data are an extract of the <em>National Survey of Childrenâ€™s Health, 2018</em>. The data contain information on childrenâ€™s exposure to various <em>Adverse Childhood Experiences</em> (ACEs) and their demographic characteristics.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">clear</span> <span class="ot">all</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">use</span> <span class="st">&quot;../predict-and-margins-substantive-example/NSCH_ACES.dta&quot;</span>, <span class="kw">clear</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">describe</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>Contains <span class="kw">data</span> from ../<span class="kw">predict</span>-and-margins-substantive-example/NSCH_ACES.dta</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a> Observations:        30,530                  </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    Variables:            23                  20 Oct 2020 14:50</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>Variable      Storage   Display    Value</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="bn">name</span>         <span class="dv">type</span>    <span class="kw">format</span>    <span class="kw">label</span>      Variable <span class="kw">label</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>sc_sex          <span class="kw">byte</span>    %30.0g     sc_sex_lab</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                                              Sex <span class="kw">of</span> Selected Child</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>ace3            <span class="kw">byte</span>    %30.0g     ace3_lab   Child Experienced - Parent <span class="kw">or</span> Guardian Divorced</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>ace4            <span class="kw">byte</span>    %30.0g     ace4_lab   Child Experienced - Parent <span class="kw">or</span> Guardian Died</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>ace5            <span class="kw">byte</span>    %30.0g     ace5_lab   Child Experienced - Parent <span class="kw">or</span> Guardian Time <span class="kw">in</span> Jail</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>ace6            <span class="kw">byte</span>    %30.0g     ace6_lab   Child Experienced - Adults Slap, Hit, Kick, Punch</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                                                Others</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>ace7            <span class="kw">byte</span>    %30.0g     ace7_lab   Child Experienced - Victim <span class="kw">of</span> Violence</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>ace8            <span class="kw">byte</span>    %30.0g     ace8_lab   Child Experienced - Lived with Mentally Ill</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>ace9            <span class="kw">byte</span>    %30.0g     ace9_lab   Child Experienced - Lived with Person with</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>                                                Alcohol/Drug Problem</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>ace10           <span class="kw">byte</span>    %30.0g     ace10_lab</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>                                              Child Experienced - Treated Unfairly Because <span class="kw">of</span> Race</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>ace1            <span class="kw">byte</span>    %30.0g     ace1_lab   Hard to Cover Basics Like Food <span class="kw">or</span> Housing</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>sc_race_r       <span class="kw">byte</span>    %48.0g     sc_race_r_lab</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>                                              Race <span class="kw">of</span> Selected Child, Detailed</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>sc_racer        <span class="kw">byte</span>    %31.0g     sc_racer_lab</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                                              Race <span class="kw">of</span> Selected Child, Recode</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>higrade         <span class="kw">byte</span>    %61.0g     higrade_lab</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>                                              Highest Level <span class="kw">of</span> Education among Reported Adults</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>depress         <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> k2q32b (Depression Currently)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>ace1R           <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> ace1 (Hard to Cover Basics Like Food <span class="kw">or</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>                                                Housing)</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>ace3R           <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> ace3 (Child Experienced - Parent <span class="kw">or</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>                                                Guardian Divorced)</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>ace4R           <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> ace4 (Child Experienced - Parent <span class="kw">or</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>                                                Guardian Died)</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>ace5R           <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> ace5 (Child Experienced - Parent <span class="kw">or</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>                                                Guardian Time <span class="kw">in</span> Jail)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>ace6R           <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> ace6 (Child Experienced - Adults Slap, Hit,</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>                                                Kick, Punch Others)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>ace7R           <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> ace7 (Child Experienced - Victim <span class="kw">of</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>                                                Violence)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>ace8R           <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> ace8 (Child Experienced - Lived with</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>                                                Mentally Ill)</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>ace9R           <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> ace9 (Child Experienced - Lived with Person</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>                                                with Alcohol/Drug Problem)</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>ace10R          <span class="kw">byte</span>    %9.0g                 RECODE <span class="kw">of</span> ace10 (Child Experienced - Treated Unfairly</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>                                                Because <span class="kw">of</span> Race)</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>Sorted <span class="kw">by</span>: </span></code></pre></div>
</div>
<div id="generate-count-of-aces" class="slide section level2">
<h1>Generate Count of Aces</h1>
<div class="sourceCode" id="cb28"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">egen</span> acecount = <span class="fu">anycount</span>(ace*R), <span class="kw">values</span>(1) <span class="co">// generate count of ACES</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">histogram</span> acecount, discrete <span class="dv">scheme</span>(michigan)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>(<span class="bn">start</span>=0, <span class="kw">width</span>=1)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">graph</span> <span class="kw">export</span> myhistogram3.png, <span class="kw">width</span>(1000) <span class="kw">replace</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>file /Users/agrogan/Desktop/GitHub/newstuff/categorical/<span class="fu">count</span>-regression/myhistogram3.png saved</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">as</span> PNG <span class="kw">format</span></span></code></pre></div>
<div class="figure">
<img src="myhistogram3.png" alt="" />
<p class="caption">Count of ACEs</p>
</div>
</div>
<div id="poisson-regression-1" class="slide section level2">
<h1>Poisson Regression</h1>
<div class="sourceCode" id="cb31"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">poisson</span> acecount sc_sex i.sc_race_r i.higrade</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>Iteration 0:   <span class="fu">log</span> likelihood = -44759.253  </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>Iteration 1:   <span class="fu">log</span> likelihood = -44758.999  </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>Iteration 2:   <span class="fu">log</span> likelihood = -44758.999  </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>Poisson regression                                     Number <span class="kw">of</span> <span class="kw">obs</span> =  30,530</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                                                       LR <span class="fu">chi2</span>(9)    = 2054.20</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                                                       Prob &gt; <span class="fu">chi2</span>   =  0.0000</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>Log likelihood = -44758.999                            Pseudo R2     =  0.0224</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>                        acecount â”‚ Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                          sc_sex â”‚   -.012823   .0111291    -1.15   0.249    -.0346357    .0089897</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                                 â”‚</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                       sc_race_r â”‚</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>Black <span class="kw">or</span> African American alone  â”‚   .2662761   .0196921    13.52   0.000     .2276802    .3048719</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>American Indian <span class="kw">or</span> Alaska Nat..  â”‚   .5971063   .0447201    13.35   0.000     .5094566     .684756</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                    Asian alone  â”‚  -.6243821   .0358521   -17.42   0.000    -.6946509   -.5541134</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>Native Hawaiian and Other Pac..  â”‚   .2067409   .0969415     2.13   0.033     .0167392    .3967427</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>          Some Other Race alone  â”‚   .0675521   .0324881     2.08   0.038     .0038765    .1312277</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>              Two <span class="kw">or</span> More Races  â”‚   .2818125   .0190548    14.79   0.000     .2444658    .3191593</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>                                 â”‚</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>                         higrade â”‚</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>High school (including vocat..)  â”‚   .0632486   .0322397     1.96   0.050       .00006    .1264372</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>          More than high school  â”‚  -.3786108    .030587   -12.38   0.000    -.4385602   -.3186615</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>                                 â”‚</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>                           <span class="dt">_cons</span> â”‚   .3399425   .0345283     9.85   0.000     .2722683    .4076166</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></code></pre></div>
</div>
<div id="incidence-rate-ratios" class="slide section level2">
<h1>Incidence Rate Ratios</h1>
<div class="sourceCode" id="cb32"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">poisson</span>, <span class="kw">irr</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>Poisson regression                                     Number <span class="kw">of</span> <span class="kw">obs</span> =  30,530</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                                                       LR <span class="fu">chi2</span>(9)    = 2054.20</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                                                       Prob &gt; <span class="fu">chi2</span>   =  0.0000</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>Log likelihood = -44758.999                            Pseudo R2     =  0.0224</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                        acecount â”‚        IRR   Std. err.      z    P&gt;|z|     [95% conf. interval]</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                          sc_sex â”‚   .9872589   .0109873    -1.15   0.249     .9659573     1.00903</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>                                 â”‚</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                       sc_race_r â”‚</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>Black <span class="kw">or</span> African American alone  â”‚   1.305095   .0257001    13.52   0.000     1.255684    1.356451</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>American Indian <span class="kw">or</span> Alaska Nat..  â”‚   1.816854   .0812498    13.35   0.000     1.664386    1.983288</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                    Asian alone  â”‚   .5355922   .0192021   -17.42   0.000     .4992487    .5745815</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>Native Hawaiian and Other Pac..  â”‚   1.229664   .1192054     2.13   0.033      1.01688    1.486973</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>          Some Other Race alone  â”‚   1.069886   .0347586     2.08   0.038     1.003884    1.140227</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>              Two <span class="kw">or</span> More Races  â”‚    1.32553   .0252577    14.79   0.000     1.276939     1.37597</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                                 â”‚</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>                         higrade â”‚</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>High school (including vocat..)  â”‚   1.065292   .0343446     1.96   0.050      1.00006    1.134778</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>          More than high school  â”‚   .6848121   .0209463   -12.38   0.000     .6449644    .7271216</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>                                 â”‚</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>                           <span class="dt">_cons</span> â”‚   1.404867   .0485076     9.85   0.000     1.312939    1.503231</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>Note: <span class="dt">_cons</span> <span class="kw">estimates</span> baseline incidence rate.</span></code></pre></div>
</div>

<div id="negative-binomial-distribution" class="title-slide slide section level1">
<h1>Negative Binomial Distribution</h1>

</div>
<div id="over-dispersion" class="slide section level2">
<h1>Over-Dispersion</h1>
<p>Due to population heterogeneity (diversity, variation), variance may be <span class="math inline">\(&gt;\)</span> mean. This is often empirically the case.</p>
<p><span class="math display">\[ \text{var}(y) &gt; \text{mean}(y) \]</span></p>
<p><span class="math display">\[ y \sim Poisson(\mu) \]</span></p>
<p><span class="math display">\[ \ln(\mu) = \beta_0 + \beta_1 x + \text{offset} + \text{dispersion} + etc. \]</span></p>
</div>
<div id="negative-binomial-regression" class="slide section level2">
<h1>Negative Binomial Regression</h1>
<div class="sourceCode" id="cb33"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">nbreg</span> acecount sc_sex i.sc_race_r i.higrade, <span class="kw">irr</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>Fitting Poisson <span class="kw">model</span>:</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>Iteration 0:   <span class="fu">log</span> likelihood = -44759.253  </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>Iteration 1:   <span class="fu">log</span> likelihood = -44758.999  </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>Iteration 2:   <span class="fu">log</span> likelihood = -44758.999  </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>Fitting constant-only <span class="kw">model</span>:</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>Iteration 0:   <span class="fu">log</span> likelihood =   -43591.3  </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>Iteration 1:   <span class="fu">log</span> likelihood = -43392.427  </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>Iteration 2:   <span class="fu">log</span> likelihood = -43391.748  </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>Iteration 3:   <span class="fu">log</span> likelihood = -43391.748  </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>Fitting full <span class="kw">model</span>:</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>Iteration 0:   <span class="fu">log</span> likelihood = -42801.127  </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>Iteration 1:   <span class="fu">log</span> likelihood = -42775.936  </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>Iteration 2:   <span class="fu">log</span> likelihood = -42775.864  </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>Iteration 3:   <span class="fu">log</span> likelihood = -42775.864  </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>Negative binomial regression                           Number <span class="kw">of</span> <span class="kw">obs</span> =  30,530</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>                                                       LR <span class="fu">chi2</span>(9)    = 1231.77</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>Dispersion: <span class="kw">mean</span>                                       Prob &gt; <span class="fu">chi2</span>   =  0.0000</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>Log likelihood = -42775.864                            Pseudo R2     =  0.0142</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>                        acecount â”‚        IRR   Std. err.      z    P&gt;|z|     [95% conf. interval]</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>                          sc_sex â”‚   .9873253   .0140708    -0.90   0.371     .9601287    1.015292</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>                                 â”‚</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>                       sc_race_r â”‚</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>Black <span class="kw">or</span> African American alone  â”‚   1.326253   .0350126    10.70   0.000     1.259374    1.396682</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>American Indian <span class="kw">or</span> Alaska Nat..  â”‚   1.864104   .1222717     9.49   0.000     1.639221    2.119839</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>                    Asian alone  â”‚   .5378757   .0222161   -15.01   0.000     .4960489    .5832294</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>Native Hawaiian and Other Pac..  â”‚   1.244574   .1624972     1.68   0.094     .9635716    1.607524</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>          Some Other Race alone  â”‚   1.083969   .0459946     1.90   0.057     .9974679    1.177971</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>              Two <span class="kw">or</span> More Races  â”‚   1.325755   .0336113    11.12   0.000     1.261488    1.393296</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>                                 â”‚</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>                         higrade â”‚</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>High school (including vocat..)  â”‚    1.06806   .0468996     1.50   0.134      .979983    1.164053</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>          More than high school  â”‚   .6831897   .0282212    -9.22   0.000     .6300572     .740803</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>                                 â”‚</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>                           <span class="dt">_cons</span> â”‚   1.403757   .0647737     7.35   0.000     1.282374    1.536629</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>                        /lnalpha â”‚  -.5443067   .0239625                     -.5912723   -.4973411</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>                           <span class="kw">alpha</span> â”‚   .5802439   .0139041                      .5536224    .6081455</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>Note: Estimates are transformed only <span class="kw">in</span> the first equation to incidence-rate ratios.</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>Note: <span class="dt">_cons</span> <span class="kw">estimates</span> baseline incidence rate.</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>LR <span class="kw">test</span> <span class="kw">of</span> <span class="kw">alpha</span>=0: chibar2(01) = 3966.27              Prob &gt;= chibar2 = 0.000</span></code></pre></div>
</div>
<div id="predicted-values" class="slide section level2">
<h1>Predicted Values</h1>
<div class="sourceCode" id="cb34"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> yhat</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>(option n assumed; predicted number <span class="kw">of</span> events)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">histogram</span> yhat, <span class="dv">scheme</span>(michigan) </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>(<span class="bn">bin</span>=44, <span class="bn">start</span>=.50284678, <span class="kw">width</span>=.05128577)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">graph</span> <span class="kw">export</span> myyhats.png, <span class="kw">width</span>(1000) <span class="kw">replace</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>file /Users/agrogan/Desktop/GitHub/newstuff/categorical/<span class="fu">count</span>-regression/myyhats.png saved <span class="kw">as</span> PNG</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">format</span></span></code></pre></div>
<div class="figure">
<img src="myyhats.png" alt="" />
<p class="caption">Predicted Count of ACEs</p>
</div>
</div>
<div id="exposure" class="slide section level2">
<h1>Exposure</h1>
<p>In some data sets, we will have a <em>years exposed</em> or <em>time exposed</em> variable. It is important to control for this variable.</p>
</div>
</body>
</html>
